using SchoolAdministration.Utils;
using SchoolAdministration.DTO;
using Aspose.Cells;
using LoadOptions = Aspose.Cells.LoadOptions;
using Newtonsoft.Json;
namespace SchoolAdministration.Services
{


    public class StaffService : IStaffService
    {
        private readonly DataAccess _Execute;

        public StaffService(DataAccess Execute)
        {
            _Execute = Execute;

        }

        string path = "C:\\Users\\rohit\\source\\repos\\WebApplication5\\WebApplication5";

        public async Task<string> GetStaffDetails()
        {

            string query = @"select * from School_Administration.staff";
            string tabledata = await _Execute.ExecuteQuery(query);
            return tabledata;
        }

        public void ConvertBase64ToFile(Payload payload)
        {
            string fileBase64 = "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"; byte[] fileAsBytes = Convert.FromBase64String(fileBase64);

            //Convert byte[] into stream
            Stream stream = new MemoryStream(fileAsBytes, 0, fileAsBytes.Length);

            //Specify load options.
            LoadOptions loadOptions = new LoadOptions(LoadFormat.Xlsx);

            //Create workbook from stream
            Aspose.Cells.Workbook workbook = new Aspose.Cells.Workbook(stream, loadOptions);

            workbook.Save(path + "\\Staff_Details.xlsx");
        }

        public async Task<List<Staff>> ConvertFileToList()
        {

            var workbook = new Aspose.Cells.Workbook(path + "\\Staff_Details.xlsx");
            workbook.Worksheets.RemoveAt("Evaluation Warning");
            workbook.Worksheets.RemoveAt("Evaluation Warning (1)");
            workbook.Save(path + "\\OutputStaff.json");
            string text = File.ReadAllText(path + "\\OutputStaff.json");

            var Staff_List = JsonConvert.DeserializeObject<List<Staff>>(text);
            return Staff_List;

        }
        public async Task<bool> InsertExcelStaffData(List<Staff> staff)
        {
            string query = @"INSERT INTO School_Administration.Staff (Staff_Id, Staff_Name, Staff_Type, Staff_ZipCode, Staff_Address)
            VALUES (@Staff_Id, @Staff_Name, @Staff_Type, @Staff_ZipCode, @Staff_Address);";
            bool Inserted = await _Execute.ExecuteQueryWithParamsStaff(query, staff);
            return (Inserted != null ? true : false);

        }
    }
}